<section class="users-section">
  <ul class="users-list">
    <% @users.each do |user| %>
      <li>
        Name: <%= user.name %>
        <span class="profile-link">
          <%= link_to 'See Profile',  user_path(user), class: 'profile-link' %>
        </span>
        <% unless current_user == user %>
          <% unless Friendship.exists?(current_user, user) %><br />
              <%= button_to "Send friend request", friendships_path, params: { id: user.id }, method: :post, class: ' btn-primary' %>
          <% end %>
          <% if Friendship.exists?(current_user, user) %>
            <% if friendship_requested?(current_user, user) %>
                <%= button_to "Confirm friendship", accept_path, params: { id: user.id }, method: :patch, class: '  btn-primary' %>
                <%= button_to "Decline friendship", decline_path, params: { id: user.id }, method: :delete, class: '  btn-primary' %>
            <% elsif friendship_pending?(current_user, user) %>
                <%= button_to "Cancel friend request", cancel_path, params: { id: user.id }, method: :delete, class: '  btn-primary' %>
            <% else %>
                <%= button_to "Remove friendship", delete_path, params: { id: user.id }, method: :delete, class: ' btn-primary' %>
            <% end %>
          <% end %>
        <% end %>
      </li>
    <% end %>
  </ul>
</section>
